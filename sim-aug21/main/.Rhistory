# cmat1 <-cmat2 <- cmat3 <- cmat4 <- cmat5 <- rep(0,J)
# cmat1[group1] <- 1
# cmat2[group2] <- 1
# cmat3[group3] <- 1
# cmat4[group4] <- 1
# cmat5[group5] <- 1
#
#  cmat1z <-cmat2z <- cmat3z <- cmat4z <- cmat5z <- rep(0,Zcat)
#  cmat1z[unique(popcts_tl$zcategorical[group1])] <- 1
#  cmat2z[unique(popcts_tl$zcategorical[group2])] <- 1
#  cmat3z[unique(popcts_tl$zcategorical[group3])] <- 1
#  cmat4z[unique(popcts_tl$zcategorical[group4])] <- 1
#  cmat5z[unique(popcts_tl$zcategorical[group5])] <- 1
#
# sampcat_groupings <- list(group1, group2, group3, group4, group5)
# df$subgroup <- 0
# for(i in 1:5){
#   df$subgroup[df$J_cell %in% sampcat_groupings[[i]]] <- i
# }
# ordered_cellcts_hihi <- order(poptbl$sampct)
# poptbl <- df %>%
#   group_by(J_cell,subgroup) %>%
#   summarise(
#     pinc = mean(p_include),
#     pxz = mean(pxz),
#     cts = n(),
#     sampct = pinc*cts,
#     wts = cts/sampct,
#     Za = mean(as.numeric(Za_categorical)),
#     Zb =  mean(as.numeric(Zb_categorical)),
#     Zc =  mean(as.numeric(Zc_categorical)),
#     cellmeans = mean(Y),
#     cellvars=var(Y),
#     avgX1=mean(X.1))
## order subgroups by proportion of X=1
# group1 <- which(poptbl$Za==5 & poptbl$Zc==2)
group1 <- which(poptbl$Zb==3 & poptbl$avgX1==1)
# group2 <- which(poptbl$Zb==4)
group2 <- which(poptbl$Za==3 & poptbl$Zb==5)
# group3 <- which(poptbl$Za==4 & poptbl$Zb==5)
group3 <- which(poptbl$Za==5 & poptbl$Zb==4)
group4 <- which(poptbl$Za == 1 & poptbl$Zb == 1)
# group5 <- which(poptbl$Zb==2 & poptbl$Za==5)
group5 <- which(poptbl$Zb==4 & poptbl$Zc == 2)
cmat1 <-cmat2 <- cmat3 <- cmat4 <- cmat5 <- rep(0,J)
cmat1[group1] <- 1
cmat2[group2] <- 1
cmat3[group3] <- 1
cmat4[group4] <- 1
cmat5[group5] <- 1
cmat1z <-cmat2z <- cmat3z <- cmat4z <- cmat5z <- rep(0,Zcat)
cmat1z[unique(popcts_tl$zcategorical[group1])] <- 1
cmat2z[unique(popcts_tl$zcategorical[group2])] <- 1
cmat3z[unique(popcts_tl$zcategorical[group3])] <- 1
cmat4z[unique(popcts_tl$zcategorical[group4])] <- 1
cmat5z[unique(popcts_tl$zcategorical[group5])] <- 1
#-- Finally, deselect all irrelevant columns from df to save memory
df <- df %>%
dplyr::select(
Z_categorical,Za_categorical,Zb_categorical,Zc_categorical,pxz,
p_include, X.1, Y, J_cell, zcts, Nj
)
summary(glm(X.1 ~ Zb_categorical*Zc_categorical + Za_categorical*Zc_categorical, data=df, family = "binomial"))
summary(poptbl$pinc)
summary(poptbl$picn)
hist(poptbl$picnn)
hist(poptbl$pinc)
mmrp
resultmat
setwd("../../0707/int/")
setwd("../../0707/binary/int/")
source("genPop_hixz_hixy.R")
rm(list=ls())
source("genPop_hixz_hixy.R")
setwd("../../binary_pinc/int/")
library(ggplot2)
wmrp <- read.csv("res_wmrp.csv",row.names=1)[,1:6]
mrp2 <- read.csv("res_mrp2.csv",row.names=1)[,1:6]
mmrp <- read.csv("res_mmrp.csv",row.names=1)[,1:6]
mrp <- read.csv("res_mrp.csv", row.names=1)[,1:6]
wfpbby <- read.csv("res_wfpbby.csv",row.names=1)
source("genPop_hixz_hixy.R")
cellmeanbias <- read.csv("cellmeanbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
cellmeanse <- read.csv("cellmeanse_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
wmrp_njbias <- read.csv("Njbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
mmrp_njbias <- read.csv("Njbias_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njbias <- read.csv("Njbias_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njse <- read.csv("Njse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njse <- read.csv("Njse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njse <- read.csv("Njse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njrmse <- read.csv("Njrmse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njrmse <- read.csv("Njrmse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njrmse <- read.csv("Njrmse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njcov <- read.csv("Njcov_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njcov <- read.csv("Njcov_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njcov <- read.csv("Njcov_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
# temp <- df %>% group_by(subgroup) %>% summarise(subgrpvar = mean(Y)*(1-mean(Y)))
# subgrpsd <- sqrt(temp$subgrpvar)
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,], mrp[1,])
rmse <- rmse[,c(1,6,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
bias <- rbind(wfpbby[2,], wmrp[2,], mmrp[2,], mrp2[2,],mrp[2,])
bias <- bias[,c(1,6,5,4,3,2)]
rownames(bias) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
SE <- rbind(wfpbby[3,], wmrp[3,], mmrp[3,], mrp2[3,],mrp[3,])
SE <- SE[,c(1,6,5,4,3,2)]
rownames(SE) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
CI_length <- rbind(wfpbby[5,], wmrp[4,], mmrp[4,], mrp2[4,],mrp[4,])
CI_length <- CI_length[,c(1,6,5,4,3,2)]
rownames(CI_length)<- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
coverage_rate <- rbind(wfpbby[7,], wmrp[5,], mmrp[5,], mrp2[5,], mrp[5,])
coverage_rate <- coverage_rate[,c(1,6,5,4,3,2)]
rownames(coverage_rate) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
# Dummy data
method <- c( "WFPBB", "WFPBB-MRP", "Multinomial-MRP","Two-Stage-MRP", "Classical MRP")
inference <- c("Overall","Group 5", "Group 4", "Group 3", "Group 2",  "Group 1")
data <- expand.grid(Method=method, Inference=inference)
#- rMSE
# start from overall WFPBB -> overall W-MRP -> overall M-MRP... -> group 5 WFPBB -> group 5 W-MRP...
data$Z <- as.numeric(as.matrix(rmse))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile() + labs(title = "rMSE for INT case", fill = "rMSE")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
#- rMSE
# start from overall WFPBB -> overall W-MRP -> overall M-MRP... -> group 5 WFPBB -> group 5 W-MRP...
data$Z <- as.numeric(as.matrix(rmse))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile() + labs(title = "rMSE for INT case", fill = "rMSE")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
rmse
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,], mrp[1,])
rmse <- rmse[,c(1,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,])
rmse <- rmse[,c(1,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
bias <- rbind(wfpbby[2,], wmrp[2,], mmrp[2,], mrp2[2,])
bias <- bias[,c(1,5,4,3,2)]
rownames(bias) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
SE <- rbind(wfpbby[3,], wmrp[3,], mmrp[3,], mrp2[3,])
SE <- SE[,c(1,5,4,3,2)]
rownames(SE) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
CI_length <- rbind(wfpbby[5,], wmrp[4,], mmrp[4,], mrp2[4,])
CI_length <- CI_length[,c(1,5,4,3,2)]
rownames(CI_length)<- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
coverage_rate <- rbind(wfpbby[7,], wmrp[5,], mmrp[5,], mrp2[5,])
coverage_rate <- coverage_rate[,c(1,5,4,3,2)]
rownames(coverage_rate) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
# Dummy data
method <- c( "WFPBB", "WFPBB-MRP", "Multinomial-MRP","Two-Stage-MRP")
inference <- c("Overall","Group 4", "Group 3", "Group 2",  "Group 1")
# start from overall WFPBB -> overall W-MRP -> overall M-MRP... -> group 5 WFPBB -> group 5 W-MRP...
data$Z <- as.numeric(as.matrix(rmse))
data <- expand.grid(Method=method, Inference=inference)
data$Z <- as.numeric(as.matrix(rmse))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile() + labs(title = "rMSE for INT case", fill = "rMSE")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
data$Z <- as.numeric(as.matrix(rmse))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile() + labs(title = "rMSE for INT case", fill = "rMSE")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
wfpbby
data$Z <- as.numeric(as.matrix(bias))
ggplot(data, aes(Method, Inference, fill= abs(Z))) +
geom_tile() +
labs(title = "Absolute bias for INT case", fill = "bias")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
data$Z <- as.numeric(as.matrix(coverage_rate))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile()+ labs(title = "95% Interval coverage for INT case", fill = "coverage")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
setwd("../main/")
library(ggplot2)
wmrp <- read.csv("res_wmrp.csv",row.names=1)[,1:6]
mrp2 <- read.csv("res_mrp2.csv",row.names=1)[,1:6]
mmrp <- read.csv("res_mmrp.csv",row.names=1)[,1:6]
mrp <- read.csv("res_mrp.csv", row.names=1)[,1:6]
wfpbby <- read.csv("res_wfpbby.csv",row.names=1)
source("genPop_hixz_hixy.R")
cellmeanbias <- read.csv("cellmeanbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
cellmeanse <- read.csv("cellmeanse_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
wmrp_njbias <- read.csv("Njbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
mmrp_njbias <- read.csv("Njbias_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njbias <- read.csv("Njbias_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njse <- read.csv("Njse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njse <- read.csv("Njse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njse <- read.csv("Njse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njrmse <- read.csv("Njrmse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njrmse <- read.csv("Njrmse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njrmse <- read.csv("Njrmse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njcov <- read.csv("Njcov_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njcov <- read.csv("Njcov_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njcov <- read.csv("Njcov_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
# temp <- df %>% group_by(subgroup) %>% summarise(subgrpvar = mean(Y)*(1-mean(Y)))
# subgrpsd <- sqrt(temp$subgrpvar)
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,])
rmse <- rmse[,c(1,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
bias <- rbind(wfpbby[2,], wmrp[2,], mmrp[2,], mrp2[2,])
bias <- bias[,c(1,5,4,3,2)]
rownames(bias) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
SE <- rbind(wfpbby[3,], wmrp[3,], mmrp[3,], mrp2[3,])
SE <- SE[,c(1,5,4,3,2)]
rownames(SE) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
CI_length <- rbind(wfpbby[5,], wmrp[4,], mmrp[4,], mrp2[4,])
CI_length <- CI_length[,c(1,5,4,3,2)]
rownames(CI_length)<- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
coverage_rate <- rbind(wfpbby[7,], wmrp[5,], mmrp[5,], mrp2[5,])
coverage_rate <- coverage_rate[,c(1,5,4,3,2)]
rownames(coverage_rate) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
# Dummy data
method <- c( "WFPBB", "WFPBB-MRP", "Multinomial-MRP","Two-Stage-MRP")
inference <- c("Overall","Group 4", "Group 3", "Group 2",  "Group 1")
data <- expand.grid(Method=method, Inference=inference)
# start from overall WFPBB -> overall W-MRP -> overall M-MRP... -> group 5 WFPBB -> group 5 W-MRP...
data$Z <- as.numeric(as.matrix(rmse))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile() + labs(title = "rMSE for MAIN case", fill = "rMSE")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
data$Z <- as.numeric(as.matrix(bias))
ggplot(data, aes(Method, Inference, fill= abs(Z))) +
geom_tile() +
labs(title = "Absolute bias for MAIN case", fill = "bias")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
## hi xz / hi xy
data$Z <- as.numeric(as.matrix(coverage_rate))
ggplot(data, aes(Method, Inference, fill= Z)) +
geom_tile()+ labs(title = "95% Interval coverage for MAIN case", fill = "coverage")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njbias %>% abs()
m2dat <- mrp2_njbias%>% abs()
mmdat <- mmrp_njbias%>% abs()
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "Absolute bias of estimated population cell count, MAIN case", fill = "bias")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")+facet_grid(. ~ Method)
#-- faceted plots
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njrmse
mmdat <- mmrp_njrmse
m2dat <- mrp2_njrmse
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "rMSE of estimated population cell count, MAIN case", fill = "rMSE")+
scale_fill_continuous(high = "#28629c", low = "#56B1F7")+
facet_grid(. ~ Method)
#-- faceted plots
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njcov
mmdat <- mmrp_njcov
m2dat <- mrp2_njcov
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "95% interval coverage rate of estimated population cell count, MAIN case", fill = "coverage")+
scale_fill_continuous(high = "#28629c", low = "#56B1F7")+
facet_grid(. ~ Method)
setwd("../int/")
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njbias %>% abs()
m2dat <- mrp2_njbias%>% abs()
mmdat <- mmrp_njbias%>% abs()
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "Absolute bias of estimated population cell count, INT case", fill = "bias")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")+facet_grid(. ~ Method)
library(ggplot2)
wmrp <- read.csv("res_wmrp.csv",row.names=1)[,1:6]
mrp2 <- read.csv("res_mrp2.csv",row.names=1)[,1:6]
mmrp <- read.csv("res_mmrp.csv",row.names=1)[,1:6]
mrp <- read.csv("res_mrp.csv", row.names=1)[,1:6]
wfpbby <- read.csv("res_wfpbby.csv",row.names=1)
source("genPop_hixz_hixy.R")
cellmeanbias <- read.csv("cellmeanbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
cellmeanse <- read.csv("cellmeanse_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
wmrp_njbias <- read.csv("Njbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
mmrp_njbias <- read.csv("Njbias_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njbias <- read.csv("Njbias_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njse <- read.csv("Njse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njse <- read.csv("Njse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njse <- read.csv("Njse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njrmse <- read.csv("Njrmse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njrmse <- read.csv("Njrmse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njrmse <- read.csv("Njrmse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njcov <- read.csv("Njcov_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njcov <- read.csv("Njcov_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njcov <- read.csv("Njcov_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
# temp <- df %>% group_by(subgroup) %>% summarise(subgrpvar = mean(Y)*(1-mean(Y)))
# subgrpsd <- sqrt(temp$subgrpvar)
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njbias %>% abs()
m2dat <- mrp2_njbias%>% abs()
mmdat <- mmrp_njbias%>% abs()
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "Absolute bias of estimated population cell count, INT case", fill = "bias")+scale_fill_continuous(high = "#28629c", low = "#56B1F7")+facet_grid(. ~ Method)
#-- faceted plots
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njrmse
mmdat <- mmrp_njrmse
m2dat <- mrp2_njrmse
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "rMSE of estimated population cell count, INT case", fill = "rMSE")+
scale_fill_continuous(high = "#28629c", low = "#56B1F7")+
facet_grid(. ~ Method)
#-- faceted plots
x <- y <- factor(1:10)
method <- c("WFPBB-MRP", "Multinomial-MRP", "Two-Stage-MRP")
data <- expand.grid(X=x,Y=y, Method = method)
wmdat <- wmrp_njcov
mmdat <- mmrp_njcov
m2dat <- mrp2_njcov
wmdat <- c(wmdat[ordered_cellcts_hihi])
m2dat <- c(m2dat[ordered_cellcts_hihi])
mmdat <- c(mmdat[ordered_cellcts_hihi])
data$Z <- c(wmdat, mmdat, m2dat)
ggplot(data, aes(x=X,y=Y, fill= Z)) +
geom_tile()+
theme(axis.ticks.y = element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.x = element_blank()) +
theme(axis.text.x = element_blank()) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
labs(title = "95% interval coverage rate of estimated population cell count, INT case", fill = "coverage")+
scale_fill_continuous(high = "#28629c", low = "#56B1F7")+
facet_grid(. ~ Method)
library(ggplot2)
wmrp <- read.csv("res_wmrp.csv",row.names=1)[,1:6]
mrp2 <- read.csv("res_mrp2.csv",row.names=1)[,1:6]
mmrp <- read.csv("res_mmrp.csv",row.names=1)[,1:6]
mrp <- read.csv("res_mrp.csv", row.names=1)[,1:6]
wfpbby <- read.csv("res_wfpbby.csv",row.names=1)
source("genPop_hixz_hixy.R")
cellmeanbias <- read.csv("cellmeanbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
cellmeanse <- read.csv("cellmeanse_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
wmrp_njbias <- read.csv("Njbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
mmrp_njbias <- read.csv("Njbias_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njbias <- read.csv("Njbias_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njse <- read.csv("Njse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njse <- read.csv("Njse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njse <- read.csv("Njse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njrmse <- read.csv("Njrmse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njrmse <- read.csv("Njrmse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njrmse <- read.csv("Njrmse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njcov <- read.csv("Njcov_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njcov <- read.csv("Njcov_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njcov <- read.csv("Njcov_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
# temp <- df %>% group_by(subgroup) %>% summarise(subgrpvar = mean(Y)*(1-mean(Y)))
# subgrpsd <- sqrt(temp$subgrpvar)
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,])
rmse <- rmse[,c(1,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
bias <- rbind(wfpbby[2,], wmrp[2,], mmrp[2,], mrp2[2,])
bias <- bias[,c(1,5,4,3,2)]
rownames(bias) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
SE <- rbind(wfpbby[3,], wmrp[3,], mmrp[3,], mrp2[3,])
SE <- SE[,c(1,5,4,3,2)]
rownames(SE) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
CI_length <- rbind(wfpbby[5,], wmrp[4,], mmrp[4,], mrp2[4,])
CI_length <- CI_length[,c(1,5,4,3,2)]
rownames(CI_length)<- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
coverage_rate <- rbind(wfpbby[7,], wmrp[5,], mmrp[5,], mrp2[5,])
coverage_rate <- coverage_rate[,c(1,5,4,3,2)]
rownames(coverage_rate) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP")
# Dummy data
method <- c( "WFPBB", "WFPBB-MRP", "Multinomial-MRP","Two-Stage-MRP")
inference <- c("Overall","Group 4", "Group 3", "Group 2",  "Group 1")
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,], mrp[1,])
rmse <- rmse[,c(1,6,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
bias <- rbind(wfpbby[2,], wmrp[2,], mmrp[2,], mrp2[2,],mrp[2,])
bias <- bias[,c(1,6,5,4,3,2)]
rownames(bias) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
SE <- rbind(wfpbby[3,], wmrp[3,], mmrp[3,], mrp2[3,],mrp[3,])
SE <- SE[,c(1,6,5,4,3,2)]
rownames(SE) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
CI_length <- rbind(wfpbby[5,], wmrp[4,], mmrp[4,], mrp2[4,],mrp[4,])
CI_length <- CI_length[,c(1,6,5,4,3,2)]
rownames(CI_length)<- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
coverage_rate <- rbind(wfpbby[7,], wmrp[5,], mmrp[5,], mrp2[5,], mrp[5,])
coverage_rate <- coverage_rate[,c(1,6,5,4,3,2)]
rownames(coverage_rate) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
# Dummy data
method <- c( "WFPBB", "WFPBB-MRP", "Multinomial-MRP","Two-Stage-MRP", "Classical MRP")
inference <- c("Overall","Group 5", "Group 4", "Group 3", "Group 2",  "Group 1")
rmse
round(rmse)
round(rmse,3)
round(bias,3)
round(CI_length)
round(CI_length,3)
round(coverage_rate,3)
setwd("../main/")
library(ggplot2)
wmrp <- read.csv("res_wmrp.csv",row.names=1)[,1:6]
mrp2 <- read.csv("res_mrp2.csv",row.names=1)[,1:6]
mmrp <- read.csv("res_mmrp.csv",row.names=1)[,1:6]
mrp <- read.csv("res_mrp.csv", row.names=1)[,1:6]
wfpbby <- read.csv("res_wfpbby.csv",row.names=1)
source("genPop_hixz_hixy.R")
cellmeanbias <- read.csv("cellmeanbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
cellmeanse <- read.csv("cellmeanse_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
wmrp_njbias <- read.csv("Njbias_wmrp.csv", header = T, row.names = 1) %>% unlist %>% as.vector
mmrp_njbias <- read.csv("Njbias_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njbias <- read.csv("Njbias_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njse <- read.csv("Njse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njse <- read.csv("Njse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njse <- read.csv("Njse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njrmse <- read.csv("Njrmse_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njrmse <- read.csv("Njrmse_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njrmse <- read.csv("Njrmse_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
wmrp_njcov <- read.csv("Njcov_wmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mmrp_njcov <- read.csv("Njcov_mmrp.csv", header = T, row.names = 1)%>% unlist %>% as.vector
mrp2_njcov <- read.csv("Njcov_mrp2.csv", header = T, row.names = 1)%>% unlist %>% as.vector
# temp <- df %>% group_by(subgroup) %>% summarise(subgrpvar = mean(Y)*(1-mean(Y)))
# subgrpsd <- sqrt(temp$subgrpvar)
rmse <- rbind(wfpbby[1,], wmrp[1,], mmrp[1,], mrp2[1,], mrp[1,])
rmse <- rmse[,c(1,6,5,4,3,2)]
rownames(rmse) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
bias <- rbind(wfpbby[2,], wmrp[2,], mmrp[2,], mrp2[2,],mrp[2,])
bias <- bias[,c(1,6,5,4,3,2)]
rownames(bias) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
SE <- rbind(wfpbby[3,], wmrp[3,], mmrp[3,], mrp2[3,],mrp[3,])
SE <- SE[,c(1,6,5,4,3,2)]
rownames(SE) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
CI_length <- rbind(wfpbby[5,], wmrp[4,], mmrp[4,], mrp2[4,],mrp[4,])
CI_length <- CI_length[,c(1,6,5,4,3,2)]
rownames(CI_length)<- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
coverage_rate <- rbind(wfpbby[7,], wmrp[5,], mmrp[5,], mrp2[5,], mrp[5,])
coverage_rate <- coverage_rate[,c(1,6,5,4,3,2)]
rownames(coverage_rate) <- c("WFPBB", "WFPBB-MRP", "Multinomial-MRP", "Two-Stage MRP", "Classical MRP")
# Dummy data
method <- c( "WFPBB", "WFPBB-MRP", "Multinomial-MRP","Two-Stage-MRP", "Classical MRP")
inference <- c("Overall","Group 5", "Group 4", "Group 3", "Group 2",  "Group 1")
rmse
round(rmse,3)
round(bias,3)
round(CI_length,3)
round(coverage_rate,3)
source("genPop_hixz_hixy.R")
range(poptbl$cts)
setwd("../int/")
source("genPop_hixz_hixy.R")
range(poptbl$cts)
mean(poptbl$cts)
setwd("../main/")
source("genPop_hixz_hixy.R")
mean(poptbl$cts)
